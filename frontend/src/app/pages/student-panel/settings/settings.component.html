<div class="min-h-screen p-6">
  <div class="max-w-5xl mx-auto">
    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-3xl font-bold text-gray-900 mb-2">Settings Profile</h1>
      <p class="text-gray-600">Manage your account settings and preferences</p>
    </div>

    <!-- Tabs -->
    <div class="bg-white rounded-xl shadow-sm mb-6 overflow-hidden">
      <div class="flex border-b border-gray-200">
        <button
          (click)="setActiveTab('profile')"
          [ngClass]="{
            'border-[#F6BD60] text-[#2D5757] bg-[#F7EDE2]/30': activeTab === 'profile'
          }"
          class="flex-1 px-6 py-4 text-center font-semibold border-b-2 border-transparent hover:bg-[#F7EDE2]/20 transition-all">
          <i class="fas fa-user mr-2"></i>
          Profile
        </button>
        <button
          (click)="setActiveTab('security')"
          [ngClass]="{
            'border-[#F6BD60] text-[#2D5757] bg-[#F7EDE2]/30': activeTab === 'security'
          }"
          class="flex-1 px-6 py-4 text-center font-semibold border-b-2 border-transparent hover:bg-[#F7EDE2]/20 transition-all">
          <i class="fas fa-lock mr-2"></i>
          Security
        </button>
        <button
          (click)="setActiveTab('notifications')"
          [ngClass]="{
            'border-[#F6BD60] text-[#2D5757] bg-[#F7EDE2]/30': activeTab === 'notifications'
          }"
          class="flex-1 px-6 py-4 text-center font-semibold border-b-2 border-transparent hover:bg-[#F7EDE2]/20 transition-all">
          <i class="fas fa-bell mr-2"></i>
          Notifications
        </button>
      </div>
    </div>

    <!-- Profile Tab -->
    <div *ngIf="activeTab === 'profile'" class="bg-white rounded-xl shadow-sm p-8">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold text-gray-900">Profile Information</h2>
        <button
          *ngIf="!isEditingProfile"
          (click)="toggleEditProfile()"
          class="px-4 py-2 bg-[#F6BD60] text-white rounded-lg hover:bg-[#e5ac4f] transition-colors">
          <i class="fas fa-edit mr-2"></i>
          Edit Profile
        </button>
      </div>

      <!-- Profile Picture -->
      <div class="flex items-center gap-6 mb-8 pb-8 border-b border-gray-200">
        <div class="relative">
          <img
            [src]="profilePicturePreview"
            alt="Profile"
            class="w-32 h-32 rounded-full border-4 border-[#F6BD60] shadow-lg object-cover">
          <button
            *ngIf="isEditingProfile"
            (click)="fileInput.click()"
            class="absolute bottom-0 right-0 w-10 h-10 bg-[#F6BD60] text-white rounded-full hover:bg-[#e5ac4f] transition-colors shadow-lg flex items-center justify-center">
            <i class="fas fa-camera"></i>
          </button>
          <input
            #fileInput
            type="file"
            accept="image/jpeg,image/jpg,image/png,image/gif,image/webp"
            (change)="onFileSelected($event)"
            class="hidden">
        </div>
        <div class="flex-1">
          <h3 class="text-xl font-bold text-gray-900">{{currentUser?.firstName}} {{currentUser?.lastName}}</h3>
          <p class="text-gray-600 mb-3">{{currentUser?.email}}</p>
          <div *ngIf="isEditingProfile" class="flex gap-2">
            <button
              (click)="fileInput.click()"
              class="px-4 py-2 bg-[#2D5757] text-white rounded-lg hover:bg-[#3D6D6D] transition-colors text-sm">
              <i class="fas fa-upload mr-2"></i>
              Change Photo
            </button>
            <button
              (click)="removeProfilePicture()"
              class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm">
              <i class="fas fa-trash mr-2"></i>
              Remove
            </button>
          </div>
        </div>
      </div>

      <!-- Profile Form -->
      <form [formGroup]="profileForm" (ngSubmit)="saveProfile()">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              First Name <span class="text-red-500">*</span>
            </label>
            <input
              type="text"
              formControlName="firstName"
              [readonly]="!isEditingProfile"
              [class.bg-gray-50]="!isEditingProfile"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#F6BD60] focus:border-transparent transition-all">
            <p *ngIf="profileForm.get('firstName')?.invalid && profileForm.get('firstName')?.touched" class="text-red-500 text-xs mt-1">
              First name is required (min 2 characters)
            </p>
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Last Name <span class="text-red-500">*</span>
            </label>
            <input
              type="text"
              formControlName="lastName"
              [readonly]="!isEditingProfile"
              [class.bg-gray-50]="!isEditingProfile"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#F6BD60] focus:border-transparent transition-all">
            <p *ngIf="profileForm.get('lastName')?.invalid && profileForm.get('lastName')?.touched" class="text-red-500 text-xs mt-1">
              Last name is required (min 2 characters)
            </p>
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Email <span class="text-red-500">*</span>
            </label>
            <input
              type="email"
              formControlName="email"
              [readonly]="!isEditingProfile"
              [class.bg-gray-50]="!isEditingProfile"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#F6BD60] focus:border-transparent transition-all">
            <p *ngIf="profileForm.get('email')?.invalid && profileForm.get('email')?.touched" class="text-red-500 text-xs mt-1">
              Please enter a valid email
            </p>
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Phone
            </label>
            <input
              type="tel"
              formControlName="phone"
              [readonly]="!isEditingProfile"
              [class.bg-gray-50]="!isEditingProfile"
              placeholder="+1 (555) 123-4567"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#F6BD60] focus:border-transparent transition-all">
            <p *ngIf="profileForm.get('phone')?.invalid && profileForm.get('phone')?.touched" class="text-red-500 text-xs mt-1">
              Please enter a valid phone number
            </p>
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              CIN
            </label>
            <input
              type="text"
              formControlName="cin"
              [readonly]="!isEditingProfile"
              [class.bg-gray-50]="!isEditingProfile"
              placeholder="AB123456"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#F6BD60] focus:border-transparent transition-all">
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Date of Birth
            </label>
            <input
              type="date"
              formControlName="dateOfBirth"
              [readonly]="!isEditingProfile"
              [class.bg-gray-50]="!isEditingProfile"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#F6BD60] focus:border-transparent transition-all">
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Address
            </label>
            <input
              type="text"
              formControlName="address"
              [readonly]="!isEditingProfile"
              [class.bg-gray-50]="!isEditingProfile"
              placeholder="123 Main Street"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#F6BD60] focus:border-transparent transition-all">
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              City
            </label>
            <input
              type="text"
              formControlName="city"
              [readonly]="!isEditingProfile"
              [class.bg-gray-50]="!isEditingProfile"
              placeholder="Tunis"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#F6BD60] focus:border-transparent transition-all">
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Postal Code
            </label>
            <input
              type="text"
              formControlName="postalCode"
              [readonly]="!isEditingProfile"
              [class.bg-gray-50]="!isEditingProfile"
              placeholder="1000"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#F6BD60] focus:border-transparent transition-all">
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              English Level
            </label>
            <select
              formControlName="englishLevel"
              [disabled]="!isEditingProfile"
              [class.bg-gray-50]="!isEditingProfile"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#F6BD60] focus:border-transparent transition-all">
              <option value="">Select Level</option>
              <option *ngFor="let level of englishLevels" [value]="level.value">{{ level.label }}</option>
            </select>
          </div>
        </div>

        <!-- Bio Field (Full Width) -->
        <div class="mb-6">
          <label class="block text-sm font-semibold text-gray-700 mb-2">
            Bio
          </label>
          <textarea
            formControlName="bio"
            [readonly]="!isEditingProfile"
            [class.bg-gray-50]="!isEditingProfile"
            rows="4"
            maxlength="500"
            placeholder="Tell us about yourself..."
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#F6BD60] focus:border-transparent transition-all resize-none"></textarea>
          <div class="flex justify-between items-center mt-1">
            <p class="text-xs text-gray-500">Maximum 500 characters</p>
            <p class="text-xs text-gray-500">{{profileForm.get('bio')?.value?.length || 0}}/500</p>
          </div>
        </div>

        <div *ngIf="isEditingProfile" class="flex gap-3 pt-6 border-t border-gray-200">
          <button
            type="submit"
            [disabled]="profileForm.invalid || isSavingProfile"
            class="px-6 py-3 bg-[#2D5757] text-white rounded-lg hover:bg-[#3D6D6D] transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
            <i *ngIf="!isSavingProfile" class="fas fa-save mr-2"></i>
            <i *ngIf="isSavingProfile" class="fas fa-spinner fa-spin mr-2"></i>
            {{isSavingProfile ? 'Saving...' : 'Save Changes'}}
          </button>
          <button
            type="button"
            (click)="toggleEditProfile()"
            [disabled]="isSavingProfile"
            class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
            Cancel
          </button>
        </div>
      </form>
    </div>

    <!-- Security Tab -->
    <div *ngIf="activeTab === 'security'" class="space-y-6">
      <!-- Change Password -->
      <div class="bg-white rounded-xl shadow-sm p-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">Change Password</h2>
        <form [formGroup]="passwordForm" (ngSubmit)="changePassword()">
          <div class="space-y-4 mb-6">
            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Current Password <span class="text-red-500">*</span>
              </label>
              <input
                type="password"
                formControlName="currentPassword"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#F6BD60] focus:border-transparent">
            </div>

            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                New Password <span class="text-red-500">*</span>
              </label>
              <input
                type="password"
                formControlName="newPassword"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#F6BD60] focus:border-transparent">
              <p class="text-xs text-gray-500 mt-1">Minimum 8 characters</p>
            </div>

            <div>
              <label class="block text-sm font-semibold text-gray-700 mb-2">
                Confirm New Password <span class="text-red-500">*</span>
              </label>
              <input
                type="password"
                formControlName="confirmPassword"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#F6BD60] focus:border-transparent">
              <p *ngIf="passwordForm.hasError('passwordMismatch') && passwordForm.get('confirmPassword')?.touched" class="text-red-500 text-xs mt-1">
                Passwords do not match
              </p>
            </div>
          </div>

          <button
            type="submit"
            [disabled]="passwordForm.invalid || isChangingPassword"
            class="px-6 py-3 bg-[#2D5757] text-white rounded-lg hover:bg-[#3D6D6D] transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
            <i *ngIf="!isChangingPassword" class="fas fa-key mr-2"></i>
            <i *ngIf="isChangingPassword" class="fas fa-spinner fa-spin mr-2"></i>
            {{isChangingPassword ? 'Changing...' : 'Change Password'}}
          </button>
        </form>
      </div>

      <!-- Two-Factor Authentication -->
      <div class="bg-white rounded-xl shadow-sm p-8">
        <div class="flex items-start justify-between">
          <div class="flex-1">
            <h3 class="text-xl font-bold text-gray-900 mb-2">Two-Factor Authentication</h3>
            <p class="text-gray-600 mb-4">Add an extra layer of security to your account</p>
            <span class="inline-block px-3 py-1 bg-gray-100 text-gray-600 text-sm rounded-full">
              <i class="fas fa-times-circle mr-1"></i>
              Not Enabled
            </span>
          </div>
          <button class="px-4 py-2 border border-[#2D5757] text-[#2D5757] rounded-lg hover:bg-[#F7EDE2] transition-colors">
            Enable
          </button>
        </div>
      </div>
    </div>

    <!-- Notifications Tab -->
    <div *ngIf="activeTab === 'notifications'" class="bg-white rounded-xl shadow-sm p-8">
      <h2 class="text-2xl font-bold text-gray-900 mb-6">Notification Preferences</h2>
      
      <div class="space-y-6">
        <div class="flex items-center justify-between py-4 border-b border-gray-200">
          <div class="flex-1">
            <h3 class="font-semibold text-gray-900 mb-1">Email Notifications</h3>
            <p class="text-sm text-gray-600">Receive email about your account activity</p>
          </div>
          <label class="relative inline-flex items-center cursor-pointer">
            <input type="checkbox" [(ngModel)]="emailNotifications" class="sr-only peer">
            <div class="w-14 h-7 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#F6BD60]/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-[#F6BD60]"></div>
          </label>
        </div>

        <div class="flex items-center justify-between py-4 border-b border-gray-200">
          <div class="flex-1">
            <h3 class="font-semibold text-gray-900 mb-1">Push Notifications</h3>
            <p class="text-sm text-gray-600">Receive push notifications on your device</p>
          </div>
          <label class="relative inline-flex items-center cursor-pointer">
            <input type="checkbox" [(ngModel)]="pushNotifications" class="sr-only peer">
            <div class="w-14 h-7 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#F6BD60]/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-[#F6BD60]"></div>
          </label>
        </div>

        <div class="flex items-center justify-between py-4 border-b border-gray-200">
          <div class="flex-1">
            <h3 class="font-semibold text-gray-900 mb-1">Course Updates</h3>
            <p class="text-sm text-gray-600">Get notified about new lessons and materials</p>
          </div>
          <label class="relative inline-flex items-center cursor-pointer">
            <input type="checkbox" [(ngModel)]="courseUpdates" class="sr-only peer">
            <div class="w-14 h-7 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#F6BD60]/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-[#F6BD60]"></div>
          </label>
        </div>

        <div class="flex items-center justify-between py-4">
          <div class="flex-1">
            <h3 class="font-semibold text-gray-900 mb-1">Assignment Reminders</h3>
            <p class="text-sm text-gray-600">Receive reminders about upcoming assignments</p>
          </div>
          <label class="relative inline-flex items-center cursor-pointer">
            <input type="checkbox" [(ngModel)]="assignmentReminders" class="sr-only peer">
            <div class="w-14 h-7 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#F6BD60]/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-[#F6BD60]"></div>
          </label>
        </div>
      </div>

      <div class="mt-8 pt-6 border-t border-gray-200">
        <button class="px-6 py-3 bg-[#2D5757] text-white rounded-lg hover:bg-[#3D6D6D] transition-colors">
          <i class="fas fa-save mr-2"></i>
          Save Preferences
        </button>
      </div>
    </div>
  </div>
</div>
