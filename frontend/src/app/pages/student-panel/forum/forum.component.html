<div class="min-h-screen bg-gray-50 p-6 animate-fade-in">
  <!-- Header -->
  <div class="mb-8">
    <div class="flex items-center justify-between mb-4">
      <div>
        <h1 class="text-3xl font-bold text-gray-900 mb-2">Community Forum ðŸ’¬</h1>
        <p class="text-gray-600">Exchange, learn and progress together</p>
      </div>
      <button 
        (click)="openNewTopicModal()"
        class="px-6 py-3 bg-gradient-to-r from-[#2D5757] to-[#3D3D60] text-white rounded-xl hover:shadow-lg transition-all flex items-center gap-2 font-semibold">
        <i class="fas fa-plus"></i>
        <span>New Topic</span>
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="flex items-center justify-center py-20">
    <div class="text-center">
      <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-[#F59E0B] mx-auto mb-4"></div>
      <p class="text-gray-600">Loading categories...</p>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="bg-red-50 border border-red-200 rounded-xl p-4 mb-6">
    <p class="text-red-700">{{ error }}</p>
    <button (click)="loadCategories()" class="mt-2 text-red-600 hover:text-red-700 font-medium">
      Retry
    </button>
  </div>

  <!-- Categories -->
  <div *ngIf="!loading && !error" class="space-y-6">
    <div *ngFor="let category of categories" class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-lg transition-all">
      <!-- Category Header -->
      <div class="p-6 border-b border-gray-100 bg-gradient-to-r from-[#F7EDE2] to-[#F7EDE2]/50">
        <div class="flex items-center gap-4">
          <div class="w-14 h-14 rounded-xl flex items-center justify-center shadow-sm bg-white text-[#2D5757]">
            <i class="fas text-2xl" [ngClass]="category.icon"></i>
          </div>
          <div>
            <h2 class="text-xl font-bold text-gray-900 mb-1">{{ category.name }}</h2>
            <p class="text-sm text-gray-600">{{ category.description }}</p>
          </div>
        </div>
      </div>

      <!-- Subcategories -->
      <div class="divide-y divide-gray-100">
        <div 
          *ngFor="let sub of category.subCategories" 
          [routerLink]="['/user-panel/forum/topics', sub.id, sub.name]"
          class="p-6 hover:bg-gray-50 transition-colors cursor-pointer group">
          <div class="flex items-start justify-between gap-4">
            <div class="flex-1">
              <div class="flex items-center gap-3 mb-2">
                <i class="fas fa-folder text-gray-400 group-hover:text-[#F59E0B] transition-colors"></i>
                <h3 class="font-semibold text-gray-900 group-hover:text-[#2D5757] transition-colors">{{ sub.name }}</h3>
              </div>
              <p class="text-sm text-gray-600">{{ sub.description }}</p>
            </div>
            <i class="fas fa-chevron-right text-gray-400 group-hover:text-[#F59E0B] transition-colors"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- New Topic Modal -->
<div *ngIf="showNewTopicModal" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50 animate-fade-in">
  <div class="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col animate-slide-up">
    <!-- Modal Header -->
    <div class="p-6 border-b border-gray-200 flex items-center justify-between bg-gradient-to-r from-[#F7EDE2] to-white">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 bg-gradient-to-br from-[#F59E0B] to-[#C84630] rounded-lg flex items-center justify-center">
          <i class="fas fa-plus text-white"></i>
        </div>
        <div>
          <h2 class="text-xl font-bold text-gray-900">Create a New Topic</h2>
          <p class="text-sm text-gray-600">Share your questions and ideas with the community</p>
        </div>
      </div>
      <button 
        (click)="closeNewTopicModal()"
        class="w-8 h-8 flex items-center justify-center rounded-lg hover:bg-gray-100 transition-colors text-gray-500 hover:text-gray-700">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <!-- Modal Body -->
    <div class="flex-1 overflow-y-auto p-6 space-y-5">
      <!-- Category Selection -->
      <div>
        <label class="block text-sm font-semibold text-gray-900 mb-2">
          Category <span class="text-red-500">*</span>
        </label>
        <select 
          [(ngModel)]="newTopic.categoryId"
          (ngModelChange)="onCategoryChange()"
          class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#F59E0B] focus:border-transparent transition-all">
          <option [ngValue]="0">Select a category</option>
          <option *ngFor="let category of categories" [ngValue]="category.id">
            {{ category.name }}
          </option>
        </select>
      </div>

      <!-- Subcategory Selection -->
      <div *ngIf="availableSubCategories.length > 0">
        <label class="block text-sm font-semibold text-gray-900 mb-2">
          Subcategory <span class="text-red-500">*</span>
        </label>
        <select 
          [(ngModel)]="newTopic.subCategoryId"
          class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#F59E0B] focus:border-transparent transition-all">
          <option [ngValue]="0">Select a subcategory</option>
          <option *ngFor="let subCat of availableSubCategories" [ngValue]="subCat.id">
            {{ subCat.name }}
          </option>
        </select>
      </div>

      <!-- Title -->
      <div>
        <label class="block text-sm font-semibold text-gray-900 mb-2">
          Topic Title <span class="text-red-500">*</span>
        </label>
        <input 
          type="text"
          [(ngModel)]="newTopic.title"
          placeholder="E.g.: How to improve my pronunciation?"
          class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#F59E0B] focus:border-transparent transition-all"
          maxlength="150">
        <p class="text-xs text-gray-500 mt-1">{{ newTopic.title.length }}/150 characters</p>
      </div>

      <!-- Content -->
      <div>
        <label class="block text-sm font-semibold text-gray-900 mb-2">
          Content <span class="text-red-500">*</span>
        </label>
        <textarea 
          [(ngModel)]="newTopic.content"
          placeholder="Describe your question or topic in detail..."
          rows="8"
          class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#F59E0B] focus:border-transparent transition-all resize-none"
          maxlength="5000"></textarea>
        <p class="text-xs text-gray-500 mt-1">{{ newTopic.content.length }}/5000 characters</p>
      </div>

      <!-- Tips -->
      <div class="bg-[#F7EDE2] border border-[#F6BD60]/30 rounded-xl p-4">
        <div class="flex gap-3">
          <i class="fas fa-lightbulb text-[#F59E0B] mt-0.5"></i>
          <div>
            <h4 class="font-semibold text-gray-900 text-sm mb-1">Tips for a Good Topic</h4>
            <ul class="text-xs text-gray-600 space-y-1">
              <li>â€¢ Choose a clear and descriptive title</li>
              <li>â€¢ Explain your question in detail</li>
              <li>â€¢ Be respectful and courteous</li>
              <li>â€¢ Check if your question hasn't already been asked</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Footer -->
    <div class="p-6 border-t border-gray-200 flex items-center justify-end gap-3">
      <button 
        (click)="closeNewTopicModal()"
        class="px-6 py-2.5 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-all font-medium">
        Cancel
      </button>
      <button 
        (click)="submitNewTopic()"
        [disabled]="!isFormValid()"
        [class.opacity-50]="!isFormValid()"
        [class.cursor-not-allowed]="!isFormValid()"
        class="px-6 py-2.5 bg-gradient-to-r from-[#F59E0B] to-[#C84630] text-white rounded-xl hover:shadow-lg transition-all font-medium disabled:opacity-50 disabled:cursor-not-allowed">
        <i class="fas fa-paper-plane mr-2"></i>
        Post Topic
      </button>
    </div>
  </div>
</div>
