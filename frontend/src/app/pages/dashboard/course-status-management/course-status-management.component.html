<div class="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 p-6">
  <div class="max-w-7xl mx-auto">
    <!-- Enhanced Header -->
    <div class="mb-8">
      <div class="flex items-center gap-3 mb-3">
        <div class="w-12 h-12 bg-gradient-to-br from-primary to-primary-600 rounded-xl flex items-center justify-center shadow-lg">
          <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
        </div>
        <div>
          <h1 class="text-3xl font-bold text-gray-900 dark:text-white">Course Status Management</h1>
          <p class="text-gray-600 dark:text-gray-400">Control course, chapter, and lesson visibility</p>
        </div>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="flex items-center justify-center py-20">
      <div class="text-center">
        <div class="animate-spin rounded-full h-16 w-16 border-4 border-primary border-t-transparent mx-auto"></div>
        <p class="mt-4 text-lg text-gray-600 dark:text-gray-400">Loading courses...</p>
      </div>
    </div>

    <!-- Error State -->
    <div *ngIf="error" class="bg-red-50 dark:bg-red-900/20 border-l-4 border-red-500 rounded-lg p-6 mb-6 shadow-sm">
      <div class="flex items-center gap-3">
        <svg class="w-6 h-6 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <p class="text-red-900 dark:text-red-200 font-medium">{{ error }}</p>
      </div>
    </div>

    <!-- Course List View -->
    <div *ngIf="!loading && !selectedCourse" class="space-y-6">
      <!-- Stats Cards -->
      <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-5">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm text-gray-600 dark:text-gray-400 mb-1">Total Courses</p>
              <p class="text-2xl font-bold text-gray-900 dark:text-white">{{ courses.length }}</p>
            </div>
            <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center">
              <svg class="w-6 h-6 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
              </svg>
            </div>
          </div>
        </div>

        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-5">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm text-gray-600 dark:text-gray-400 mb-1">Published</p>
              <p class="text-2xl font-bold text-green-600 dark:text-green-400">{{ getPublishedCount() }}</p>
            </div>
            <div class="w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center">
              <svg class="w-6 h-6 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </div>
          </div>
        </div>

        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-5">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm text-gray-600 dark:text-gray-400 mb-1">Draft</p>
              <p class="text-2xl font-bold text-gray-600 dark:text-gray-400">{{ getDraftCount() }}</p>
            </div>
            <div class="w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center">
              <svg class="w-6 h-6 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path>
              </svg>
            </div>
          </div>
        </div>

        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-5">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm text-gray-600 dark:text-gray-400 mb-1">Archived</p>
              <p class="text-2xl font-bold text-orange-600 dark:text-orange-400">{{ getArchivedCount() }}</p>
            </div>
            <div class="w-12 h-12 bg-orange-100 dark:bg-orange-900/30 rounded-lg flex items-center justify-center">
              <svg class="w-6 h-6 text-orange-600 dark:text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"></path>
              </svg>
            </div>
          </div>
        </div>
      </div>

      <!-- Search and Filter -->
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-4 mb-6">
        <div class="flex items-center gap-3">
          <div class="flex-1 relative">
            <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
            <input
              type="text"
              [(ngModel)]="searchTerm"
              placeholder="Search courses by title, description, or tutor..."
              class="w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent transition-all">
          </div>
        </div>
      </div>

      <!-- Courses Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <div
          *ngFor="let course of filteredCourses"
          (click)="selectCourse(course)"
          class="group bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden cursor-pointer hover:shadow-xl hover:border-primary transition-all duration-300 transform hover:-translate-y-1">
          
          <!-- Course Thumbnail -->
          <div class="relative h-48 bg-gradient-to-br from-primary/10 to-primary/5 dark:from-primary/20 dark:to-primary/10 overflow-hidden">
            <img *ngIf="course.thumbnailUrl" [src]="course.thumbnailUrl" [alt]="course.title" class="w-full h-full object-cover">
            <div *ngIf="!course.thumbnailUrl" class="w-full h-full flex items-center justify-center">
              <svg class="w-20 h-20 text-primary/30" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
              </svg>
            </div>
            
            <!-- Status Badge -->
            <div class="absolute top-3 right-3">
              <span
                class="px-3 py-1.5 text-xs font-semibold rounded-full shadow-lg backdrop-blur-sm"
                [ngClass]="{
                  'bg-green-500/90 text-white': course.status === CourseStatus.PUBLISHED,
                  'bg-gray-500/90 text-white': course.status === CourseStatus.DRAFT,
                  'bg-orange-500/90 text-white': course.status === CourseStatus.ARCHIVED
                }">
                {{ course.status === CourseStatus.PUBLISHED ? '‚úì Published' : course.status === CourseStatus.ARCHIVED ? 'üì¶ Archived' : '‚úé Draft' }}
              </span>
            </div>

            <!-- Featured Badge -->
            <div *ngIf="course.isFeatured" class="absolute top-3 left-3">
              <span class="px-3 py-1.5 text-xs font-semibold rounded-full bg-yellow-500/90 text-white shadow-lg backdrop-blur-sm">
                ‚≠ê Featured
              </span>
            </div>
          </div>

          <!-- Course Content -->
          <div class="p-5">
            <div class="flex items-start justify-between mb-3">
              <h3 class="text-lg font-bold text-gray-900 dark:text-white line-clamp-2 group-hover:text-primary transition-colors">
                {{ course.title }}
              </h3>
            </div>

            <p class="text-sm text-gray-600 dark:text-gray-400 line-clamp-2 mb-4">{{ course.description }}</p>

            <!-- Course Meta Info -->
            <div class="space-y-2 mb-4">
              <div class="flex items-center gap-2 text-sm">
                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                </svg>
                <span class="text-gray-600 dark:text-gray-400">{{ course.tutorName || 'No tutor assigned' }}</span>
              </div>

              <div class="flex items-center gap-4 text-sm">
                <div class="flex items-center gap-1.5">
                  <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                  </svg>
                  <span class="text-gray-600 dark:text-gray-400">{{ course.category }}</span>
                </div>
                <div class="flex items-center gap-1.5">
                  <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                  </svg>
                  <span class="text-gray-600 dark:text-gray-400">{{ course.level }}</span>
                </div>
              </div>

              <div class="flex items-center gap-4 text-sm">
                <div class="flex items-center gap-1.5">
                  <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                  <span class="text-gray-600 dark:text-gray-400">{{ course.duration || 0 }}h</span>
                </div>
                <div class="flex items-center gap-1.5">
                  <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                  </svg>
                  <span class="text-gray-600 dark:text-gray-400">{{ course.chapterCount || 0 }} chapters</span>
                </div>
              </div>
            </div>

            <!-- Action Button -->
            <div class="flex items-center gap-2 pt-4 border-t border-gray-200 dark:border-gray-700">
              <button
                (click)="$event.stopPropagation(); updateCourseStatus(course, course.status !== CourseStatus.PUBLISHED)"
                class="flex-1 px-4 py-2.5 text-sm font-semibold rounded-lg transition-all duration-200 transform hover:scale-105"
                [ngClass]="{
                  'bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600': course.status === CourseStatus.PUBLISHED,
                  'bg-gradient-to-r from-primary to-primary-600 text-white hover:from-primary-600 hover:to-primary-700 shadow-lg': course.status !== CourseStatus.PUBLISHED
                }">
                {{ course.status === CourseStatus.PUBLISHED ? '‚äó Unpublish' : '‚úì Publish' }}
              </button>
              <button
                (click)="$event.stopPropagation(); selectCourse(course)"
                class="px-4 py-2.5 text-sm font-semibold text-primary hover:text-primary-600 dark:text-primary-400 dark:hover:text-primary-300 transition-colors">
                View Details ‚Üí
              </button>
            </div>
          </div>
        </div>
      </div>

      <div *ngIf="filteredCourses.length === 0" class="text-center py-20">
        <svg class="w-24 h-24 text-gray-300 dark:text-gray-600 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <p class="text-xl text-gray-500 dark:text-gray-400 mb-2">No courses found</p>
        <p class="text-sm text-gray-400 dark:text-gray-500">Try adjusting your search criteria</p>
      </div>
    </div>

    <!-- Course Detail View -->
    <div *ngIf="!loading && selectedCourse" class="space-y-6">
      <!-- Back Button & Course Header -->
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
        <!-- Course Banner -->
        <div class="relative h-64 bg-gradient-to-br from-primary/20 to-primary/5 dark:from-primary/30 dark:to-primary/10">
          <img *ngIf="selectedCourse.thumbnailUrl" [src]="selectedCourse.thumbnailUrl" [alt]="selectedCourse.title" class="w-full h-full object-cover opacity-50">
          <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"></div>
          
          <button
            (click)="backToCourseList()"
            class="absolute top-4 left-4 inline-flex items-center gap-2 px-4 py-2 bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm text-gray-700 dark:text-gray-300 rounded-lg hover:bg-white dark:hover:bg-gray-800 transition-all shadow-lg">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
            Back to Courses
          </button>

          <div class="absolute bottom-6 left-6 right-6">
            <div class="flex items-end justify-between">
              <div class="flex-1">
                <h2 class="text-3xl font-bold text-white mb-2 drop-shadow-lg">{{ selectedCourse.title }}</h2>
                <p class="text-white/90 text-lg drop-shadow">{{ selectedCourse.description }}</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Course Info Bar -->
        <div class="p-6 bg-gray-50 dark:bg-gray-900/50 border-b border-gray-200 dark:border-gray-700">
          <div class="flex flex-wrap items-center gap-6">
            <div class="flex items-center gap-2">
              <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
              </svg>
              <span class="text-sm font-medium text-gray-700 dark:text-gray-300">{{ selectedCourse.tutorName || 'No tutor' }}</span>
            </div>
            <div class="flex items-center gap-2">
              <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
              </svg>
              <span class="text-sm font-medium text-gray-700 dark:text-gray-300">{{ selectedCourse.category }}</span>
            </div>
            <div class="flex items-center gap-2">
              <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
              </svg>
              <span class="text-sm font-medium text-gray-700 dark:text-gray-300">Level: {{ selectedCourse.level }}</span>
            </div>
            <div class="flex items-center gap-2">
              <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <span class="text-sm font-medium text-gray-700 dark:text-gray-300">{{ selectedCourse.duration || 0 }} hours</span>
            </div>
            
            <div class="ml-auto flex items-center gap-3">
              <span
                class="px-4 py-2 text-sm font-semibold rounded-lg"
                [ngClass]="{
                  'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400': selectedCourse.status === CourseStatus.PUBLISHED,
                  'bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400': selectedCourse.status === CourseStatus.DRAFT,
                  'bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400': selectedCourse.status === CourseStatus.ARCHIVED
                }">
                {{ selectedCourse.status === CourseStatus.PUBLISHED ? '‚úì Published' : selectedCourse.status === CourseStatus.ARCHIVED ? 'üì¶ Archived' : '‚úé Draft' }}
              </span>
              <button
                (click)="updateCourseStatus(selectedCourse, selectedCourse.status !== CourseStatus.PUBLISHED)"
                class="px-5 py-2.5 text-sm font-semibold rounded-lg transition-all duration-200 transform hover:scale-105 shadow-lg"
                [ngClass]="{
                  'bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600': selectedCourse.status === CourseStatus.PUBLISHED,
                  'bg-gradient-to-r from-primary to-primary-600 text-white hover:from-primary-600 hover:to-primary-700': selectedCourse.status !== CourseStatus.PUBLISHED
                }">
                {{ selectedCourse.status === CourseStatus.PUBLISHED ? '‚äó Unpublish Course' : '‚úì Publish Course' }}
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Chapters & Lessons -->
      <div class="space-y-4">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-3">
            <svg class="w-7 h-7 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
            </svg>
            Chapters & Lessons
          </h3>
          <span class="text-sm text-gray-500 dark:text-gray-400">{{ chapters.length }} chapters total</span>
        </div>
        
        <div *ngFor="let chapter of chapters; let chapterIndex = index" class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden hover:shadow-md transition-shadow">
          <!-- Chapter Header -->
          <div class="p-5 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors" (click)="toggleChapter(chapter.id!)">
            <div class="flex items-start gap-4">
              <!-- Chapter Number Badge -->
              <div class="flex-shrink-0 w-12 h-12 bg-gradient-to-br from-primary to-primary-600 rounded-xl flex items-center justify-center text-white font-bold text-lg shadow-lg">
                {{ chapterIndex + 1 }}
              </div>

              <!-- Chapter Info -->
              <div class="flex-1 min-w-0">
                <div class="flex items-start justify-between gap-4 mb-2">
                  <div class="flex-1">
                    <h4 class="text-lg font-bold text-gray-900 dark:text-white mb-1">{{ chapter.title }}</h4>
                    <p class="text-sm text-gray-600 dark:text-gray-400 line-clamp-2">{{ chapter.description }}</p>
                  </div>
                  
                  <svg
                    class="w-6 h-6 text-gray-400 transition-transform duration-200 flex-shrink-0"
                    [ngClass]="{ 'rotate-90': expandedChapters.has(chapter.id!) }"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                  </svg>
                </div>

                <!-- Chapter Meta -->
                <div class="flex items-center gap-4 mt-3">
                  <div class="flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    <span>{{ lessons[chapter.id!]?.length || 0 }} lessons</span>
                  </div>

                  <div class="flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span>{{ chapter.estimatedDuration || 0 }} min</span>
                  </div>

                  <span
                    class="px-3 py-1 text-xs font-semibold rounded-full"
                    [ngClass]="{
                      'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400': chapter.isPublished,
                      'bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400': !chapter.isPublished
                    }">
                    {{ chapter.isPublished ? '‚úì Published' : '‚úé Draft' }}
                  </span>

                  <button
                    (click)="$event.stopPropagation(); updateChapterStatus(chapter, !chapter.isPublished)"
                    class="ml-auto px-4 py-1.5 text-sm font-semibold rounded-lg transition-all duration-200 hover:scale-105"
                    [ngClass]="{
                      'bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600': chapter.isPublished,
                      'bg-gradient-to-r from-primary to-primary-600 text-white hover:from-primary-600 hover:to-primary-700 shadow-md': !chapter.isPublished
                    }">
                    {{ chapter.isPublished ? '‚äó Unpublish' : '‚úì Publish' }}
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Lessons List -->
          <div *ngIf="expandedChapters.has(chapter.id!)" class="border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/30">
            <div *ngIf="lessons[chapter.id!]" class="divide-y divide-gray-200 dark:divide-gray-700">
              <div *ngFor="let lesson of lessons[chapter.id!]; let lessonIndex = index" 
                   class="p-4 hover:bg-gray-100 dark:hover:bg-gray-800/50 transition-colors">
                <div class="flex items-center gap-4">
                  <!-- Lesson Number -->
                  <div class="flex-shrink-0 w-10 h-10 bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 rounded-lg flex items-center justify-center text-gray-600 dark:text-gray-400 font-semibold text-sm">
                    {{ lessonIndex + 1 }}
                  </div>

                  <!-- Lesson Type Icon -->
                  <div class="flex-shrink-0 w-10 h-10 rounded-lg flex items-center justify-center"
                       [ngClass]="{
                         'bg-red-100 dark:bg-red-900/30': lesson.lessonType === 'VIDEO',
                         'bg-blue-100 dark:bg-blue-900/30': lesson.lessonType === 'TEXT',
                         'bg-green-100 dark:bg-green-900/30': lesson.lessonType === 'DOCUMENT',
                         'bg-yellow-100 dark:bg-yellow-900/30': lesson.lessonType === 'QUIZ',
                         'bg-pink-100 dark:bg-pink-900/30': lesson.lessonType === 'ASSIGNMENT',
                         'bg-purple-100 dark:bg-purple-900/30': lesson.lessonType === 'INTERACTIVE'
                       }">
                    <svg class="w-5 h-5"
                         [ngClass]="{
                           'text-red-600 dark:text-red-400': lesson.lessonType === 'VIDEO',
                           'text-blue-600 dark:text-blue-400': lesson.lessonType === 'TEXT',
                           'text-green-600 dark:text-green-400': lesson.lessonType === 'DOCUMENT',
                           'text-yellow-600 dark:text-yellow-400': lesson.lessonType === 'QUIZ',
                           'text-pink-600 dark:text-pink-400': lesson.lessonType === 'ASSIGNMENT',
                           'text-purple-600 dark:text-purple-400': lesson.lessonType === 'INTERACTIVE'
                         }"
                         fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path *ngIf="lesson.lessonType === 'VIDEO'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                      <path *ngIf="lesson.lessonType === 'TEXT'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                      <path *ngIf="lesson.lessonType === 'DOCUMENT'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                      <path *ngIf="lesson.lessonType === 'QUIZ'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path>
                      <path *ngIf="lesson.lessonType === 'ASSIGNMENT'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                      <path *ngIf="lesson.lessonType === 'INTERACTIVE'" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"></path>
                    </svg>
                  </div>

                  <!-- Lesson Info -->
                  <div class="flex-1 min-w-0">
                    <h5 class="font-semibold text-gray-900 dark:text-white mb-1">{{ lesson.title }}</h5>
                    <div class="flex items-center gap-3 text-xs text-gray-500 dark:text-gray-400">
                      <span class="px-2 py-0.5 rounded-full font-medium"
                            [ngClass]="{
                              'bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400': lesson.lessonType === 'VIDEO',
                              'bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400': lesson.lessonType === 'TEXT',
                              'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400': lesson.lessonType === 'DOCUMENT',
                              'bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400': lesson.lessonType === 'QUIZ',
                              'bg-pink-100 text-pink-700 dark:bg-pink-900/30 dark:text-pink-400': lesson.lessonType === 'ASSIGNMENT',
                              'bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400': lesson.lessonType === 'INTERACTIVE'
                            }">
                        {{ lesson.lessonType }}
                      </span>
                      <span class="flex items-center gap-1">
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        {{ lesson.duration || 0 }} min
                      </span>
                      <span *ngIf="lesson.isPreview" class="px-2 py-0.5 bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400 rounded-full font-medium">
                        üëÅÔ∏è Preview
                      </span>
                    </div>
                  </div>

                  <!-- Lesson Status & Actions -->
                  <div class="flex items-center gap-3">
                    <span
                      class="px-3 py-1 text-xs font-semibold rounded-full"
                      [ngClass]="{
                        'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400': lesson.isPublished,
                        'bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400': !lesson.isPublished
                      }">
                      {{ lesson.isPublished ? '‚úì Published' : '‚úé Draft' }}
                    </span>
                    <button
                      (click)="updateLessonStatus(lesson, !lesson.isPublished)"
                      class="px-4 py-1.5 text-sm font-semibold rounded-lg transition-all duration-200 hover:scale-105"
                      [ngClass]="{
                        'bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600': lesson.isPublished,
                        'bg-gradient-to-r from-primary to-primary-600 text-white hover:from-primary-600 hover:to-primary-700 shadow-md': !lesson.isPublished
                      }">
                      {{ lesson.isPublished ? '‚äó Unpublish' : '‚úì Publish' }}
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <div *ngIf="!lessons[chapter.id!]" class="p-8 text-center">
              <div class="animate-spin rounded-full h-8 w-8 border-2 border-primary border-t-transparent mx-auto mb-3"></div>
              <p class="text-sm text-gray-500 dark:text-gray-400">Loading lessons...</p>
            </div>
          </div>
        </div>

        <div *ngIf="chapters.length === 0" class="text-center py-20 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700">
          <svg class="w-24 h-24 text-gray-300 dark:text-gray-600 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
          </svg>
          <p class="text-xl text-gray-500 dark:text-gray-400 mb-2">No chapters found</p>
          <p class="text-sm text-gray-400 dark:text-gray-500">This course doesn't have any chapters yet</p>
        </div>
      </div>
    </div>
  </div>
</div>
